var InstantClick=function(e,t){function p(e){var t=e.indexOf("#");return 0>t?e:e.substr(0,t)}function _(e){for(;e&&"A"!=e.nodeName;)e=e.parentNode;return e}function y(e){var n=t.protocol+"//"+t.host;if(!(n=e.target||e.hasAttribute("download")||0!=e.href.indexOf(n+"/")||-1<e.href.indexOf("#")&&p(e.href)==c)){if(z){a:{do{if(!e.hasAttribute)break;if(e.hasAttribute("data-no-instant"))break;if(e.hasAttribute("data-instant")){e=!0;break a}}while(e=e.parentNode)e=!1}e=!e}else a:{do{if(!e.hasAttribute)break;if(e.hasAttribute("data-instant"))break;if(e.hasAttribute("data-no-instant")){e=!0;break a}}while(e=e.parentNode)e=!1}n=e}return!n}function u(e,t,n,s){for(var o,a=!1,i=0;i<v[e].length;i++)"receive"==e?(o=v[e][i](t,n,s),o&&("body"in o&&(n=o.body),"title"in o&&(s=o.title),a=o)):v[e][i](t,n,s);return a}function T(t,n,s,o){if(e.documentElement.replaceChild(n,e.body),s){if(history.pushState(null,null,s),n=s.indexOf("#"),n=-1<n&&e.getElementById(s.substr(n+1)),o=0,n)for(;n.offsetParent;)o+=n.offsetTop,n=n.offsetParent;scrollTo(0,o),c=p(s)}else scrollTo(0,o);e.title=I&&e.title==t?t+String.fromCharCode(160):t,S(),b.done(),u("change",!1),t=e.createEvent("HTMLEvents"),t.initEvent("instantclick:newpage",!0,!0),dispatchEvent(t)}function F(e){x>+new Date-500||(e=_(e.target))&&y(e)&&m(e.href)}function M(e){x>+new Date-500||(e=_(e.target))&&y(e)&&(e.addEventListener("mouseout",R),E?(D=e.href,o=setTimeout(m,E)):m(e.href))}function H(e){x=+new Date,(e=_(e.target))&&y(e)&&(g?e.removeEventListener("mousedown",F):e.removeEventListener("mouseover",M),m(e.href))}function P(e){var t=_(e.target);!t||!y(t)||1<e.which||e.metaKey||e.ctrlKey||(e.preventDefault(),A(t.href))}function R(){o?(clearTimeout(o),o=!1):h&&!n&&(l.abort(),n=h=!1)}function L(){if(!(4>l.readyState)&&0!=l.status){if(r.ready=+new Date-r.start,l.getResponseHeader("Content-Type").match(/\/(x|ht|xht)ml/)){o=e.implementation.createHTMLDocument(""),o.documentElement.innerHTML=l.responseText.replace(/<noscript[\s\S]+<\/noscript>/gi,""),f=o.title,d=o.body,t=u("receive",a,d,f),t&&("body"in t&&(d=t.body),"title"in t&&(f=t.title)),t=p(a),s[t]={body:d,title:f,scrollY:t in s?s[t].scrollY:0};for(var i,c,o=o.head.children,t=0,h=o.length-1;0<=h;h--)if(i=o[h],i.hasAttribute("data-instant-track")){i=i.getAttribute("href")||i.getAttribute("src")||i.innerHTML;for(c=O.length-1;0<=c;c--)O[c]==i&&t++}t!=O.length&&(w=!0)}else w=!0;n&&(n=!1,A(a))}}function S(t){if(e.body.addEventListener("touchstart",H,!0),g?e.body.addEventListener("mousedown",F,!0):e.body.addEventListener("mouseover",M,!0),e.body.addEventListener("click",P,!0),!t){t=e.body.getElementsByTagName("script");var n,s,o,a;i=0;for(j=t.length;i<j;i++)n=t[i],n.hasAttribute("data-no-instant")||(s=e.createElement("script"),n.src&&(s.src=n.src),n.innerHTML&&(s.innerHTML=n.innerHTML),o=n.parentNode,a=n.nextSibling,o.removeChild(n),o.insertBefore(s,a))}}function m(e){!g&&"display"in r&&100>+new Date-(r.start+r.display)||(o&&(clearTimeout(o),o=!1),e||(e=D),h&&(e==a||n))||(h=!0,n=!1,a=e,w=d=!1,r={start:+new Date},u("fetch"),l.open("GET",e),l.send())}function A(e){"display"in r||(r.display=+new Date-r.start),o||!h?o&&a&&a!=e?t.href=e:(m(e),b.start(0,!0),u("wait"),n=!0):n?t.href=e:w?t.href=a:d?(s[c].scrollY=pageYOffset,n=h=!1,T(f,d,a)):(b.start(0,!0),u("wait"),n=!0)}var o,c,l,g,x,E,z,D,C=navigator.userAgent,I=-1<C.indexOf(" CriOS/"),k="createTouch"in e,s={},a=!1,f=!1,w=!1,d=!1,r={},h=!1,n=!1,O=[],v={fetch:[],receive:[],wait:[],change:[]},b=function(){function c(n,o){s=n,e.getElementById(t.id)&&e.body.removeChild(t),t.style.opacity="1",e.getElementById(t.id)&&e.body.removeChild(t),a(),o&&setTimeout(u,0),clearTimeout(i),i=setTimeout(l,500)}function u(){s=10,a()}function l(){s+=1+2*Math.random(),98<=s?s=98:i=setTimeout(l,500),a()}function a(){n.style[o]="translate("+s+"%)",e.getElementById(t.id)||e.body.appendChild(t)}function d(){e.getElementById(t.id)?(clearTimeout(i),s=100,a(),t.style.opacity="0"):(c(100==s?0:s),setTimeout(d,0))}function r(){t.style.left=pageXOffset+"px",t.style.width=innerWidth+"px",t.style.top=pageYOffset+"px";var e="orientation"in window&&90==Math.abs(orientation);t.style[o]="scaleY("+innerWidth/screen[e?"height":"width"]*2+")"}var t,n,s,o,i;return{init:function(){t=e.createElement("div"),t.id="instantclick",n=e.createElement("div"),n.id="instantclick-bar",n.className="instantclick-bar",t.appendChild(n);var s,a,i=["Webkit","Moz","O"];if(o="transform",!(o in n.style))for(s=0;3>s;s++)i[s]+"Transform"in n.style&&(o=i[s]+"Transform");if(a="transition",!(a in n.style))for(s=0;3>s;s++)i[s]+"Transition"in n.style&&(a="-"+i[s].toLowerCase()+"-"+a);i=e.createElement("style"),i.innerHTML="#instantclick{position:"+(k?"absolute":"fixed")+";top:0;left:0;width:100%;pointer-events:none;z-index:2147483647;"+a+":opacity .25s .1s}.instantclick-bar{background:#29d;width:100%;margin-left:-100%;height:2px;"+a+":all .25s}",e.head.appendChild(i),k&&(r(),addEventListener("resize",r),addEventListener("scroll",r))},start:c,done:d}}(),N="pushState"in history&&(!C.match("Android")||C.match("Chrome/"))&&"file:"!=t.protocol;return{supported:N,init:function(){if(!c)if(N){for(n=arguments.length-1;0<=n;n--)o=arguments[n],!0===o?z=!0:"mousedown"==o?g=!0:"number"==typeof o&&(E=o);c=p(t.href),s[c]={body:e.body,title:e.title,scrollY:pageYOffset};for(var i,o=e.head.children,n=o.length-1;0<=n;n--)i=o[n],i.hasAttribute("data-instant-track")&&(i=i.getAttribute("href")||i.getAttribute("src")||i.innerHTML,O.push(i));l=new XMLHttpRequest,l.addEventListener("readystatechange",L),S(!0),b.init(),u("change",!0),addEventListener("popstate",function(){var e=p(t.href);e!=c&&(e in s?(s[c].scrollY=pageYOffset,c=e,T(s[e].title,s[e].body,!1,s[e].scrollY)):t.href=t.href)})}else u("change",!0)},on:function(e,t){v[e].push(t)}}}(document,location)